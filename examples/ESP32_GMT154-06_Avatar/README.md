# ESP32 GMT154-06 Avatar

このプロジェクトはESP32マイコンとGMT154-06 LCDパネルを使用して、M5Stack-Avatarライブラリを移植したものです。LovyanGFXライブラリを使用してディスプレイを制御し、その上にアバターを表示します。

## ハードウェア要件

- ESP32開発ボード
- GMT154-06 LCDパネル（ST7789ドライバ搭載）
- 接続ワイヤー
- タッチセンサー

## 接続方法

LCDパネルとESP32の接続は以下の通りです：

| LCD ピン | ESP32 ピン |
|---------|-----------|
| RESET   | IO4       |
| D/C     | IO2       |
| DATA    | IO23      |
| CLK     | IO18      |
| バックライト | IO25      |

タッチセンサーの接続：

| センサー | ESP32 ピン |
|---------|-----------|
| タッチセンサー | IO32 (T9) |

## ソフトウェア要件

- PlatformIO
- Arduino Framework for ESP32
- LovyanGFX ライブラリ（v1.1.9以上）
- M5Stack-Avatar ライブラリ（v0.10.0）

## ビルド方法

1. PlatformIOをインストールします
2. このプロジェクトをクローンまたはダウンロードします
3. PlatformIOでプロジェクトを開きます
4. ビルドしてESP32にアップロードします

## 動作説明

起動後、LCDパネルにアバターの顔が表示されます。IO32ピンに接続されたタッチセンサーを約0.3秒間タッチすると、アバターの表情が切り替わります。また、口の動きはランダムに変化します。

## 実装の特徴

1. **LovyanGFXの使用**:
   - M5Stackハードウェアの代わりにGMT154-06 LCDパネルを使用
   - SPIバスとST7789ドライバの設定を最適化
   - アバターのサイズはオリジナルの80%に縮小

2. **M5Stack-Avatarの移植**:
   - M5Stackクラスの代わりにLovyanGFXを使用するためのラッパークラスを実装
   - アバターの表情や口の動きを制御する機能を実装

3. **タッチセンサーによる操作**:
   - ESP32のIO32ピン（T9）をタッチセンサーとして使用
   - タッチしきい値は83に設定
   - 約0.3秒のタッチで表情を切り替え

3. **表情の変化**:
   - Neutral（通常）、Happy（幸せ）、Sleepy（眠い）、Sad（悲しい）、Doubt（疑問）の5種類の表情
   - タッチセンサー（IO32）を約0.3秒間タッチすると表情が切り替わる

4. **リップシンク**:
   - 口の開き具合をランダムに変化させることでリップシンクをシミュレート
   - 口の動きは0から0.33の範囲でランダムに変化

## 参考リポジトリ

このプロジェクトは以下のリポジトリを参考に作成されています：
- [M5Stack-Avatar](https://github.com/mongonta0716/m5stack-avatar)
- [LovyanGFX](https://github.com/lovyan03/LovyanGFX)

## トラブルシューティング

- ディスプレイが表示されない場合は、接続を確認してください
- タッチセンサーが動作しない場合は、コード内のタッチしきい値を調整してみてください
- ライブラリのインストールに問題がある場合は、PlatformIOのライブラリマネージャーを使用して手動でインストールしてみてください
## ライセンス

MITライセンスの下で公開されています。詳細はLICENSEファイルを参照してください。
